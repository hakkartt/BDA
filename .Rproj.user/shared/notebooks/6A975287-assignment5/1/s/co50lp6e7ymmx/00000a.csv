"0","library(aaltobda)"
"0","data(""bioassay"")"
"0","mu_0 = c(0, 10)"
"0","sigma_0 =  matrix(c(4, 10, 10, 100), 2, 2)"
"0","density_ratio <- function(alpha_propose,"
"0","                          alpha_previous,"
"0","                          beta_propose,"
"0","                          beta_previous,"
"0","                          x,"
"0","                          y,"
"0","                          n){"
"0","  "
"0","  # Compute the log-density of a multivariate normal prior"
"0","  log_prior = dmvnorm(matrix(c(x, y), 1, 2), mu_0, sigma_0, log = TRUE)"
"0","  print(log_prior)"
"0","  log_likelihood_prop = bioassaylp(alpha_propose, beta_propose, x, y, n)"
"0","  log_likelihood_prev = bioassaylp(alpha_previous, beta_previous, x, y, n)"
"0","  "
"0","  "
"0","  # The unnormalized log posterior is simply the sum of log-likelihood and log-prior"
"0","  log_posterior_prop = (log_prior + log_likelihood_prop)"
"0","  log_posterior_prev = (log_prior + log_likelihood_prev)"
"0","  "
"0","  # Calculate the ratio as suggested in the BDA3 eq. 11.1"
"0","  # NOTE: Remember that p1/p0 = exp(log(p1) âˆ’ log(p0))!"
"0","  exp(log_posterior_prop - log_posterior_prev)"
"0","}"
"0","density_ratio(alpha_propose = 1.89, alpha_previous = 0.374, "
"0","              beta_propose = 24.76, beta_previous = 20.04,"
"0","              x = bioassay$x, y = bioassay$y, n = bioassay$n)"
"1","[1]"
"1"," -5.225035"
"1","
"
"1","[1]"
"1"," 2.053543"
"1","
"

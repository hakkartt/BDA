"0","posterior_mean <- function(alpha, beta){"
"0"," weights = normalized_importance_weights(alpha, beta)"
"0"," c(sum(alpha*weights), sum(beta*weights))"
"0","}"
"0","means = posterior_mean(alpha_sample, beta_sample)"
"0","mean_alpha = means[1]"
"0","mean_beta = means[2]"
"0","# variance for the importance sampling"
"0","variance <- function(alpha, beta){"
"0","  w = normalized_importance_weights(alpha, beta)"
"0","  "
"0","  # E(x)^2"
"0","  Ealpha_squared = sum(alpha*w)^2 / sum(w)"
"0","  Ebeta_squared = sum(beta*w)^2 / sum(w)"
"0","  "
"0","  # E(x^2)"
"0","  E_alphasquared = sum(alpha^2*w) / sum(w)"
"0","  E_betasquared = sum(beta^2*w) / sum(w)"
"0","  "
"0","  # var(x) = E(x^2) - E(x)^2"
"0","  c((E_alphasquared - Ealpha_squared), (E_betasquared - Ebeta_squared))"
"0","}"
"0","# posterior mean MCSE"
"0","posterior_mean_MCSE <- function(alpha, beta){"
"0","  "
"0","  v = variance(alpha, beta)"
"0","  var_alpha = v[1]"
"0","  var_beta = v[2]"
"0","  "
"0","  mcse_alpha = sqrt( var_alpha / S_eff(alpha, beta) )"
"0","  mcse_beta = sqrt( var_beta / S_eff(alpha, beta) )"
"0","  c(mcse_alpha, mcse_beta)"
"0","}"
